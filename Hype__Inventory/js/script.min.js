var Inventory=new Vue({el:"#app",data:{active:!0,environment:!1,exchange:!1,modification:!0,trunk:!1,context:!1,itemInfo:!1,divide:!1,divideMax:200,divideValue:50,itemInfoTimeActivation:.5,thirstPercent:86,hungryPercent:92,nickname:"Legenda_rus",amount:26e6,opponentNickname:"Ivan_Petrov",opponentAmount:1e6,allItems:[{id:"1",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,class:"medium",serialNumber:"KFDF-0023-FDS5",description:"Это синий калаш."},{id:"2",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,class:"ordinary",serialNumber:"KFDF-0023-FDS5",description:"Это серый калаш."},{id:"3",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,class:"low",serialNumber:"KFDF-0023-FDS5",description:"Это зеленый калаш."},{id:"4",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,class:"epic",serialNumber:"KFDF-0023-FDS5",description:"Это фиолетовый калаш."},{id:"5",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,class:"legendary",serialNumber:"KFDF-0023-FDS5",description:"Это желтый калаш."},{id:"6",name:"Яд",weight:.6,amount:200,img:"img/items/poison.png",width:2,height:2,serialNumber:"KFDF-0023-FDS5",description:"Выпей яду"},{id:"7",name:"WTF",weight:.4,amount:5,img:"img/items/idk-wtf.png",width:1,height:1,serialNumber:"KFDF-0023-FDS5",description:"Хз, что это. Но лучше не пить."},{id:"8",name:"Backpack",weight:1.2,amount:1,img:"img/items/backpack.png",width:2,height:2,serialNumber:"KFDF-0023-FDS5",description:"Я рюкзак, я рюкзак!"},{id:"9",name:"Яд",weight:.6,amount:200,img:"img/items/poison.png",width:1,height:1,serialNumber:"KFDF-0023-FDS5",description:"Выпей яду"}],itemInfoItem:"",bagShow:!0,exchangeReady:!1,exchangeOpponentReady:!0,mousedown:!1,mouseover:!1,maxWeight:30,itemsInventory:[{id:"1",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,slot_id:"20",class:"medium",serialNumber:"KFDF-0023-FDS5",description:"Это синий калаш."},{id:"7",name:"WTF",weight:.4,amount:5,img:"img/items/idk-wtf.png",width:1,height:1,slot_id:"1",fast_slot_id:"1",serialNumber:"KFDF-0023-FDS5",description:"Хз, что это. Но лучше не пить."}],itemsInventorySlots:{},itemsBug:[{id:"1",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,slot_id:"3",class:"medium",serialNumber:"KFDF-0023-FDS5",description:"Это синий калаш."},{id:"2",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,slot_id:"17",class:"ordinary",serialNumber:"KFDF-0023-FDS5",description:"Это серый калаш."}],itemsBugSlots:{},itemsOpponent:[{id:"1",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,slot_id:"3",class:"medium",serialNumber:"KFDF-0023-FDS5",description:"Это синий калаш."},{id:"2",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,slot_id:"14",class:"ordinary",serialNumber:"KFDF-0023-FDS5",description:"Это серый калаш."}],itemsOpponentSlots:{},itemsProponent:[{id:"1",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,slot_id:"3",class:"medium",serialNumber:"KFDF-0023-FDS5",description:"Это синий калаш."},{id:"2",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,slot_id:"14",class:"ordinary",serialNumber:"KFDF-0023-FDS5",description:"Это серый калаш."}],itemsProponentSlots:{},itemsTrunk:[{id:"1",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,slot_id:"3",class:"medium",serialNumber:"KFDF-0023-FDS5",description:"Это синий калаш."},{id:"2",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,slot_id:"14",class:"ordinary",serialNumber:"KFDF-0023-FDS5",description:"Это серый калаш."},{id:"8",name:"Рюкзак",weight:1.2,amount:1,img:"img/items/backpack.png",width:2,height:2,slot_id:"31",serialNumber:"KFDF-0023-FDS5",description:"Я рюкзак, я рюкзак!"}],itemsTrunkSlots:{},itemsEnvironment:[{id:"1",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,slot_id:"3",class:"medium",serialNumber:"KFDF-0023-FDS5",description:"Это синий калаш."},{id:"2",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,slot_id:"14",class:"ordinary",serialNumber:"KFDF-0023-FDS5",description:"Это серый калаш."}],itemsEnvironmentSlots:{},fastSlotsInventory:{1:{isEmpty:!0,item:{}},2:{isEmpty:!0,item:{}},3:{isEmpty:!0,item:{}},4:{isEmpty:!0,item:{}}},characterSlotsInventory:{1:{slotId:1,title:"ШАПКА",type:"Hat",item:{},img:"img/icon__hat.svg",isEmpty:!0},2:{slotId:2,title:"МАСКА",type:"Mask",item:{},img:"img/icon__hat.svg",isEmpty:!0},3:{slotId:3,title:"ОЧКИ",type:"Glasses",item:{},img:"img/icon__glasses.svg",isEmpty:!0},4:{slotId:4,title:"ВЕРХ-ОДЕЖ",type:"Top",item:{},img:"img/icon__jacket.svg",isEmpty:!0},5:{slotId:5,title:"БРОНЬ",type:"BodyArmor",item:{},img:"img/icon__jacket-life.svg",isEmpty:!0},6:{slotId:6,title:"БРАСЛЕТЫ",type:"Braclets",item:{},img:"img/icon__bracelet.svg",isEmpty:!0},7:{slotId:7,title:"МАЙКА",type:"Undershirt",item:{},img:"img/icon__t-shirt.svg",isEmpty:!0},8:{slotId:8,title:"ПЕРЧАТКИ",type:"Gloves",item:{},img:"img/icon__gloves.svg",isEmpty:!0},9:{slotId:9,title:"ЧАСЫ",type:"Jewelry",item:{},img:"img/icon__watch.svg",isEmpty:!0},10:{slotId:10,title:"ШТАНЫ",type:"Leg",item:{},img:"img/icon__trousers.svg",isEmpty:!0},11:{slotId:11,title:"ОБУВЬ",type:"Feet",item:{},img:"img/icon__shoes.svg",isEmpty:!0},12:{slotId:12,title:"СУМКА",type:"Bag",item:{id:"8",name:"Рюкзак",weight:1.2,amount:1,img:"img/items/backpack.png",width:2,height:2,slot_id:"31",serialNumber:"KFDF-0023-FDS5",description:"Я рюкзак, я рюкзак!"},img:"img/icon__backpack.svg",isEmpty:!1}},itemsModifySlots:{1:{slotId:1,type:"Clip",title:"Магазин",item:{id:"7",name:"WTF",weight:.4,amount:5,img:"img/items/idk-wtf.png",width:1,height:1,slot_id:"1",fast_slot_id:"1",serialNumber:"KFDF-0023-FDS5",description:"Хз, что это. Но лучше не пить."},img:"src/assets/img/weapon/clip.png",isEmpty:!1,isDroppable:!0},2:{slotId:2,title:"Фонарик",type:"Flashlight",item:{},img:"src/assets/img/weapon/flashlight.png",isEmpty:!0,isDroppable:!0},3:{slotId:3,title:"Прицел",type:"Scope",item:{id:"7",name:"WTF",weight:.4,amount:5,img:"img/items/idk-wtf.png",width:1,height:1,slot_id:"1",fast_slot_id:"1",serialNumber:"KFDF-0023-FDS5",description:"Хз, что это. Но лучше не пить."},img:"src/assets/img/weapon/scope.png",isEmpty:!1,isDroppable:!0},4:{slotId:4,title:"Глушитель",type:"Suppressor",item:{},img:"src/assets/img/weapon/suppressor.png",isEmpty:!0,isDroppable:!0},5:{slotId:5,title:"Текстура",type:"Texture",item:{},img:"src/assets/img/weapon/texture.png",isEmpty:!0,isDroppable:!0},6:{slotId:6,title:"",type:"",item:{},img:"",isEmpty:!0,isFuture:!0},7:{slotId:7,title:"",type:"",item:{},img:"",isEmpty:!0,isFuture:!0},8:{slotId:8,title:"",type:"",item:{},img:"",isEmpty:!0,isFuture:!0}},modifyItemActive:{id:"1",name:"АК 74",weight:12.1,amount:200,img:"img/items/AK 74.png",width:4,height:2,class:"medium",serialNumber:"KFDF-0023-FDS5",description:"Это синий калаш."},INVENTORY_COUNT_ITEMS_IN_ROW:8,INVENTORY_COUNT_CELLS:136,BUG_COUNT_ITEMS_IN_ROW:8,BUG_COUNT_CELLS:128,EXCHANGE_COUNT_ITEMS_IN_ROW:6,EXCHANGE_COUNT_CELLS:54,TRUNK_COUNT_ITEMS_IN_ROW:6,TRUNK_COUNT_CELLS:162,ENVIRONMENT_COUNT_ITEMS_IN_ROW:6,ENVIRONMENT_COUNT_CELLS:162,BORDER_WIDTH:.1,BLOCK_WIDTH:5.3},methods:{json(){this.amount=this.addChars(this.amount,".",3),this.opponentAmount=this.addChars(this.opponentAmount,".",3)},draggableElementsListeners(){document.querySelectorAll(".draggable").forEach(t=>{t.onmousedown=t=>{1!=t.which||t.currentTarget.closest(".environment")||(this.mousedown=!0),this.clickAnimation(t)},t.oncontextmenu=t=>{this.audio.play(),document.querySelector(".item-info").classList.add("hide");let i=document.querySelector(".context-menu");if(this.context)return this.context=!1,setTimeout(()=>{i.style.left=t.pageX+"px",i.style.top=t.pageY+"px",this.context=!0},100),!1;i.style.left=t.pageX+"px",i.style.top=t.pageY+"px",this.context=!0},this.itemInfoFunc(t)}),document.onclick=t=>{this.context=!1},document.onmouseup=()=>{this.mousedown=!1}},clickAnimation(t){let i=document.querySelector(".click");i&&i.remove();let e=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div"),n=document.querySelector("#app .app__container");e.className="click",e.style.top=t.pageY+"px",e.style.left=t.pageX+"px",s.className="before",o.className="after",e.appendChild(s),e.appendChild(o),n.appendChild(e),i=document.querySelector(".click"),setTimeout(()=>{i.classList.add("active")},5),setTimeout(()=>{i.remove()},800)},itemInfoFunc(t){let i,e,s,o=this.itemInfoTimeActivation,n=document.querySelector(".item-info");const m=()=>{i=i||Date.now(),Date.now()-i<1e3*o?requestAnimationFrame(m):e&&(this.changeInfoItem(s.dataset.id),n.classList.remove("hide"))};t.onmousemove=function(t){i=Date.now(),e=!0,s=t.currentTarget,n.classList.add("hide"),n.classList.contains("hide")&&(n.style.left=t.pageX+20+"px",n.style.top=t.pageY+1+"px"),requestAnimationFrame(m),lastPosX=t.pageX,lastPosY=t.pageY},t.onmouseout=function(t){cancelAnimationFrame(m),e=!1}},throwActivation(){document.querySelector(".throw").onmouseover=()=>{this.mouseover=!0},document.querySelector(".throw").onmouseout=()=>{this.mouseover=!1}},progressBars(t,i){setTimeout(()=>{var e=[{val:[],value:100,size:100}];var s=d3.arc().innerRadius(160).outerRadius(200).startAngle(0).endAngle((function(t){return t.value/t.size*2*Math.PI})),o=d3.selectAll(t).append("svg").attr("viewBox","0 0 400 400").selectAll(".field").data(e).enter().append("g").attr("transform","translate(200,200)").attr("class","field"),n=(o.append("path").attr("class","path path--background").attr("d",s),o.append("path").attr("class","path path--foreground"));let m=0;function a(t){t.value=t.val;var i=d3.interpolate({value:t.previous},t);return m++,function(t){return s(i(t))}}o.each((function(t){t.previous=0,t.val=100*i/100,m++})),setTimeout(()=>{n.transition().duration(800).attrTween("d",a)},700),m=0},200)},exchanheInput(){let t=document.querySelector(".confirm__amount"),i=document.querySelector(".confirm__button");t.onkeypress=t=>{if((t=t||window.event).charCode&&0!=t.charCode&&46!=t.charCode&&(t.charCode<48||t.charCode>57))return!1},t.onfocus=function(){this.classList.add("focus")},t.onblur=function(){""==this.value&&this.classList.remove("focus")},i.onclick=t=>{t.preventDefault()}},divideFunc(){let t=document.querySelector(".divide__range.range"),i=t.querySelector(".range__input"),e=document.querySelector(".divide__input input"),s=t.querySelector("[class*=fill]"),o=t.querySelector("[class*=thumb]");function n(){s.style.width=i.value/i.max*100+"%",o.style.left=i.value/i.max*100+"%"}e.value=this.divideValue+"шт.",e.onfocus=function(){this.classList.add("focus")},e.onblur=function(){""==this.value&&this.classList.remove("focus")},e.onclick=()=>{e.setSelectionRange((this.divideValue+"шт.").length-3,(this.divideValue+"шт.").length-3)},e.onkeydown=t=>{if(!/\d/.test(t.key)&&8!=t.keyCode||/F\d/.test(t.key))return!1;t.preventDefault(),8==t.keyCode?this.divideValue=this.divideValue.slice(0,-1):0==this.divideValue?this.divideValue=t.key:this.divideValue=this.divideValue+t.key,+this.divideValue>+this.divideMax&&(this.divideValue=this.divideMax.toString()),""==this.divideValue?(this.divideValue="0",e.value=""):e.value=this.divideValue+"шт.",e.setSelectionRange((this.divideValue+"шт.").length-3,(this.divideValue+"шт.").length-3),i.value=this.divideValue,n()},i.value=this.divideValue,n(),i.oninput=()=>{this.divideValue=i.value,e.value=this.divideValue+"шт.",e.classList.add("focus"),"0"==this.divideValue&&(e.value="",e.classList.remove("focus")),n()}},changeInfoItem(t){for(let i=0;i<this.allItems.length;i++)if(+t==+this.allItems[i].id)return void(this.itemInfoItem=this.allItems[i])},addChars(t,i,e){let s,o,n=0,m=0,a=[];for(s=String(t).split("").reverse();n<s.length;)o=(n+1)%e,a[m]=s[n],0!==o||n===s.length-1?(n++,m++):(a[++m]=i,n++,m++);return a.reverse().join("")},audioActivation(){this.audio=new Audio("audio/click2.mp3"),this.audio.preload="auto",this.audio.volume=.5},renderContextMenu:()=>arr=[{title:"Применить",action:"actionUse"},{title:"Разделить",action:"actionDivide"},{title:"Модификация",action:"actionModification"}],initCommonSlots(t,i,e,s){for(let t=1;t<=e;t++)i[t]={isEmpty:!0,item:void 0};t.forEach(t=>{if(t.slot_id){i[t.slot_id]={isEmpty:!1,item:t};let e=[],o=parseInt(t.slot_id);if(t.h&&t.w&&(t.h>1||t.w>1))for(let i=0;i<t.h;i++)for(let n=0;n<t.w;n++){let t=o+n+s*i;e.push(t)}e.forEach(e=>{i[e].isEmpty=!1,i[e].slotId=t.slot_id})}})},initFastSlots(){this.itemsInventory.forEach(t=>{if(t.fast_slot_id){let i=t.fast_slot_id;this.fastSlotsInventory[i].isEmpty=!1,this.fastSlotsInventory[i].item=t}})}},computed:{inventoryWeight:function(){let t=0;return this.itemsInventory.forEach(i=>{t+=i.weight}),Math.round(10*t)/10},trunkWeight:function(){let t=0;return this.itemsTrunk.forEach(i=>{t+=i.weight}),Math.round(10*t)/10},fontSize:function(){let t=window.getComputedStyle(document.querySelector("html")).fontSize;return+t.substring(0,t.length-2)}},mounted(){this.json(),this.initCommonSlots(this.itemsInventory,this.itemsInventorySlots,this.INVENTORY_COUNT_CELLS,this.INVENTORY_COUNT_ITEMS_IN_ROW),this.initCommonSlots(this.itemsBug,this.itemsBugSlots,this.BUG_COUNT_CELLS,this.BUG_COUNT_ITEMS_IN_ROW),this.initCommonSlots(this.itemsProponent,this.itemsProponentSlots,this.EXCHANGE_COUNT_CELLS,this.EXCHANGE_COUNT_ITEMS_IN_ROW),this.initCommonSlots(this.itemsOpponent,this.itemsOpponentSlots,this.EXCHANGE_COUNT_CELLS,this.EXCHANGE_COUNT_ITEMS_IN_ROW),this.initCommonSlots(this.itemsTrunk,this.itemsTrunkSlots,this.TRUNK_COUNT_CELLS,this.TRUNK_COUNT_ITEMS_IN_ROW),this.initCommonSlots(this.itemsEnvironment,this.itemsEnvironmentSlots,this.ENVIRONMENT_COUNT_CELLS,this.ENVIRONMENT_COUNT_ITEMS_IN_ROW),this.initFastSlots(),this.throwActivation(),this.progressBars(".inventory-bag .roll",this.inventoryWeight/this.maxWeight*100),this.progressBars(".trunk .roll",this.trunkWeight/this.maxWeight*100),this.exchanheInput(),this.divideFunc(),this.audioActivation(),setTimeout(()=>{this.draggableElementsListeners(),document.querySelectorAll("img").forEach(t=>{t.ondragstart=()=>!1})},10)}});